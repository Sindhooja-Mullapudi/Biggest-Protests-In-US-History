(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{DQjk:function(e,t,a){"use strict";a.r(t),a.d(t,"ExpressMapBuilder",(function(){return z}));var r=a("VtSi"),o=a.n(r),s=a("cxan"),i=a("9fIP"),n=a("MMYH"),p=a("pWxA"),l=a("K/z8"),c=a("sRHE"),d=a("8K1b"),u=a("zjfJ"),b=a("ERkP"),f=a.n(b),O=a("2SGB"),h=a("YQpL"),j=a("/rJK"),g=a.n(j),M=a("A7aE"),m=a("+L/X"),D=a("T+qs"),w=a("gMe1"),S=a("+2DB"),v=a("/wLg"),y=a("mmNb"),P=a("6Omi"),C=a("ZjWX"),x=a("/StV"),k=a("M6On"),E=a("m+lF"),A=f.a.createElement;function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function I(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var z=function(e){Object(d.a)(r,e);var t,a=(t=r,function(){var e,a=Object(c.a)(t);if(I()){var r=Object(c.a)(this).constructor;e=Reflect.construct(a,arguments,r)}else e=a.apply(this,arguments);return Object(l.a)(this,e)});function r(e){var t;return Object(i.a)(this,r),t=a.call(this,e),Object(u.a)(Object(p.a)(t),"renderMapViewer",(function(){var e=A(y.a,{text:t.props.caption||"",placeholder:t.props.intl.formatMessage({id:"builder.map.addCaptionPlaceholder"}),updateCaption:t.props.updateCaption,insertTextBlock:t.props.insertTextBlock,alignmentLg:t.props.captionAlignmentLg,isIntersecting:t.props.isIntersecting,id:t.props.blockId,customCaptionColors:t.props.customCaptionColors,updateCustomCaptionColors:t.props.updateCustomCaptionColors});return A(b.Fragment,null,t.renderEditorModal(),t.renderPropertiesModal(),t.state.expressMapData&&A(E.default,Object(s.a)({},t.props,{data:t.state.expressMapData||!0,viewerType:S.a.Builder,mediaWrapperCaption:e})))})),Object(u.a)(Object(p.a)(t),"renderEditorModal",(function(){return A(v.a,{isShowingModal:t.props.isEditorOpen,type:"fill"},A(P.default,{ariaLabel:t.props.alt,itemResourceName:t.props.itemId,shouldSaveOverrides:t.props.isForOverriding,onCancel:t.closeEditor,onPlaceMap:t.onPlaceMap,data:t.getOverriddenData(t.state.expressMapData),shouldDisableAllMapConfigs:t.props.shouldDisableAllMapConfigs}))})),Object(u.a)(Object(p.a)(t),"renderPropertiesModal",(function(){var e=[{id:"expressmap-properties",modalProperties:[{id:"expressMapAltText",title:A(O.a,{id:"builder.common.altText"}),description:A(O.a,{id:"builder.map.propertiesDescription"}),value:t.state.localAlt,onChange:t.handleInputChange}]}];return A(C.a,{isShowingModal:t.state.isShowingSettingsModal,mediaTitle:t.props.intl.formatMessage({id:"builder.map.expressMapProperties"}),tabs:e,onConfirm:t.onPropertiesModalConfirm,onDiscard:t.onPropertiesModalDiscard})})),Object(u.a)(Object(p.a)(t),"openEditor",(function(){return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.awrap(t.props.setIsEditorOpen(!0));case 2:case"end":return e.stop()}}),null,null,null,Promise)})),Object(u.a)(Object(p.a)(t),"closeEditor",(function(){return o.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.awrap(t.props.setIsEditorOpen(!1));case 2:case"end":return e.stop()}}),null,null,null,Promise)})),Object(u.a)(Object(p.a)(t),"onPlaceMap",(function(e){var a=e.data,r=e.overridingData;r&&(g()(Object(w.b)(t.props))!==g()(r)&&t.props.updateOverridingData(r));if(a){var o=t.updateDrawingsWithRuntimeStyles(a);g()(t.state.expressMapData)!==g()(o)&&(t.props.onSaveOriginalMap(),t.setState({expressMapData:o}))}t.closeEditor()})),Object(u.a)(Object(p.a)(t),"updateDrawingsWithRuntimeStyles",(function(e){return T({},e,{drawings:T({},Object(D.b)(e.drawings,t.props.storyDesign.storyTheme.themeVariables))})})),Object(u.a)(Object(p.a)(t),"getOverriddenData",(function(e){return e&&T({},e,{},Object(w.b)(t.props))})),Object(u.a)(Object(p.a)(t),"resetAlt",(function(){t.setState({localAlt:t.props.alt})})),Object(u.a)(Object(p.a)(t),"handleInputChange",(function(e){t.setState({localAlt:e.target.value})})),Object(u.a)(Object(p.a)(t),"updateAlt",(function(){t.props.updateAlt(t.state.localAlt)})),Object(u.a)(Object(p.a)(t),"onPropertiesModalConfirm",(function(){t.updateAlt(),t.closePropertiesModal()})),Object(u.a)(Object(p.a)(t),"onPropertiesModalDiscard",(function(){t.resetAlt(),t.closePropertiesModal()})),Object(u.a)(Object(p.a)(t),"openPropertiesModal",(function(){t.setState({isShowingSettingsModal:!0})})),Object(u.a)(Object(p.a)(t),"closePropertiesModal",(function(){t.setState({isShowingSettingsModal:!1})})),t.state={expressMapData:void 0,localAlt:t.props.alt,isShowingSettingsModal:!1},t}return Object(n.a)(r,[{key:"componentDidMount",value:function(){Object(w.c)(this)}},{key:"render",value:function(){var e=this.props.showSizeOptions?{full:!0,float:!0,wide:!0,standard:!0}:{full:!1,float:!1,wide:!1,standard:!1};return this.props.showFullToolbar?A(x.a,{size:this.props.size,possibleSizes:e,onDeleteClicked:this.props.delete,onSettingsClicked:this.openPropertiesModal,updateSize:this.props.updateSize,onEditClicked:this.openEditor,shouldShowMediaToolbar:!this.props.isFullScreen},this.renderMapViewer()):A(k.a,{onDeleteClicked:this.props.delete,onSettingsClicked:this.props.showSettingsOption?this.openPropertiesModal:void 0,onEditClicked:this.openEditor},this.renderMapViewer())}},{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.alt!==e.alt)this.setState({localAlt:this.props.alt});else if(this.state.expressMapData&&e.storyDesign.storyTheme.themeVariables!==this.props.storyDesign.storyTheme.themeVariables){var a=this.updateDrawingsWithRuntimeStyles(this.state.expressMapData);this.setState({expressMapData:a})}else!e.bakedData&&this.props.bakedData&&this.setState({expressMapData:this.updateDrawingsWithRuntimeStyles(this.props.bakedData)},(function(){t.props.clearBakedData()}))}}]),r}(b.Component);t.default=Object(M.b)(Object(h.c)(Object(m.a)(z)))}}]);