(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{uxux:function(t,e,n){"use strict";n.r(e),n.d(e,"AttributionBuilder",(function(){return N}));var o=n("VtSi"),s=n.n(o),i=n("9fIP"),a=n("MMYH"),r=n("pWxA"),c=n("K/z8"),l=n("sRHE"),u=n("8K1b"),d=n("zjfJ"),p=n("yFcC"),b=n.n(p),h=n("ERkP"),x=n.n(h),m=n("YQpL"),g=n("O94r"),f=n.n(g),y=n("WXRn"),C=n("Z34l"),j=n("NX3A"),O=n("liFR"),A=n("xNfo"),w=n("Pmyh"),v=n("60Hg"),B=n("e3Gu"),E=n("Z4N4"),_=n("eCu0"),k=n("LqVs"),T=n("A7aE"),S=n("72yd"),R=n("02jS"),P=n("ClPg"),D=n("apoR"),I=n("gcFr"),q=n("nOCn"),F=x.a.createElement;function M(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var N=function(t){Object(u.a)(o,t);var e,n=(e=o,function(){var t,n=Object(l.a)(e);if(M()){var o=Object(l.a)(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Object(c.a)(this,t)});function o(t){var e;return Object(i.a)(this,o),e=n.call(this,t),Object(d.a)(Object(r.a)(e),"toolbarOptions",["bold","italic","link",{color:P.d}]),Object(d.a)(Object(r.a)(e),"onFocus",(function(){e.setState({shouldShowActionBtns:!0})})),Object(d.a)(Object(r.a)(e),"onBlur",(function(){e.setState({shouldShowActionBtns:e.props.isTouchDevice})})),Object(d.a)(Object(r.a)(e),"renderActionButtons",(function(){return F("div",{className:b.a.dynamic([["3913005616",[j.a.spacing.xxxs,j.a.spacing.xxxs,j.a.spacing.xxxxs,j.a.spacing.xxxxs,e.props.storyDesign.storyTheme.themeVariables.titleColor,j.a.color.alertRed]]])+" action-btns-container"},F(O.a,{tooltipContent:e.props.intl.formatMessage({id:"builder.common.drag"})},F("button",{className:b.a.dynamic([["3913005616",[j.a.spacing.xxxs,j.a.spacing.xxxs,j.a.spacing.xxxxs,j.a.spacing.xxxxs,e.props.storyDesign.storyTheme.themeVariables.titleColor,j.a.color.alertRed]]])+" dnd-handle"},F(A.a,{width:j.a.spacing.xxs,height:"auto"}))),F(O.a,{tooltipContent:e.props.intl.formatMessage({id:"builder.common.delete"})},F("button",{onClick:e.props.onDelete,className:b.a.dynamic([["3913005616",[j.a.spacing.xxxs,j.a.spacing.xxxs,j.a.spacing.xxxxs,j.a.spacing.xxxxs,e.props.storyDesign.storyTheme.themeVariables.titleColor,j.a.color.alertRed]]])+" delete"},F(w.a,{width:j.a.spacing.xxs,height:"auto"}))),F(b.a,{id:"3913005616",dynamic:[j.a.spacing.xxxs,j.a.spacing.xxxs,j.a.spacing.xxxxs,j.a.spacing.xxxxs,e.props.storyDesign.storyTheme.themeVariables.titleColor,j.a.color.alertRed]},[".action-btns-container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:absolute;top:1.2rem;left:".concat(j.a.spacing.xxxs,";}"),"html[dir='rtl'] .action-btns-container.__jsx-style-dynamic-selector{left:unset;right:".concat(j.a.spacing.xxxs,";}"),".dnd-handle.__jsx-style-dynamic-selector,html[dir='rtl'] .delete.__jsx-style-dynamic-selector{margin-right:".concat(j.a.spacing.xxxxs,";margin-left:0;}"),".delete.__jsx-style-dynamic-selector,html[dir='rtl'] .dnd-handle.__jsx-style-dynamic-selector{margin-left:".concat(j.a.spacing.xxxxs,";margin-right:0;}"),".dnd-handle.__jsx-style-dynamic-selector,.delete.__jsx-style-dynamic-selector{color:".concat(e.props.storyDesign.storyTheme.themeVariables.titleColor,";}"),".delete.__jsx-style-dynamic-selector:hover{color:".concat(j.a.color.alertRed,";}")]))})),Object(d.a)(Object(r.a)(e),"showActionButtons",(function(){e.setState({shouldShowActionBtns:!0})})),Object(d.a)(Object(r.a)(e),"hideActionButtons",(function(){e.setState({shouldShowActionBtns:!1})})),Object(d.a)(Object(r.a)(e),"renderPlusButton",(function(){return F("div",{className:"jsx-1903876324 plus-button-container"},F("button",{ref:e.plusBtnRef,onClick:e.props.insertAttributionBlock,"aria-label":e.props.intl.formatMessage({id:"builder.credits.plusButton.label"}),className:"jsx-1903876324"},F(O.a,{tooltipContent:e.props.intl.formatMessage({id:"builder.credits.plusButton.label"})},F(v.a,{width:j.a.spacing.xxs,height:"auto",color:e.props.storyDesign.storyTheme.themeVariables.titleColor}))),F(b.a,{id:"1903876324"},[".plus-button-container.jsx-1903876324{text-align:center;position:absolute;left:50%;bottom:0;-webkit-transform:translate(-50%,50%);-ms-transform:translate(-50%,50%);transform:translate(-50%,50%);z-index:1;}",".plus-button-container.jsx-1903876324,button.jsx-1903876324{line-height:0;}","button.jsx-1903876324{border-radius:50%;}"]))})),Object(d.a)(Object(r.a)(e),"renderAttribution",(function(){var t={modules:{toolbar:Object(y.b)()?e.toolbarOptions.slice().reverse():e.toolbarOptions,keyboard:{bindings:{tab:{key:9,handler:function(){return e.plusBtnRef.current&&e.plusBtnRef.current.focus(),!1}},enter:{key:13,handler:e.props.insertAttributionBlock}}}}};return F("div",{role:"button",onFocus:e.startEditingState,onBlur:e.stopEditingState},F(B.a,{variant:"inline",placeholder:e.props.intl.formatMessage({id:"builder.credits.attribution.placeholder"}),initHtml:e.props.attribution,onHtmlChange:e.onAttributionChange,render:e.renderAttributionEditor,tooltipLinkPlaceholder:S.c,postQuillInit:e.postAttrInit,initOptions:t,id:e.props.blockId,disabledToolbarOptions:e.state.isPublicUser?{paragraph:["custom-input"]}:{paragraph:[]},disabledColorBtnTooltip:e.state.isPublicUser?e.props.intl.formatMessage({id:"publicAccount.disabled"}):"",shouldCompareInitialContent:!1,onCustomTextColorsChange:e.onCustomAttrColorsChange}))})),Object(d.a)(Object(r.a)(e),"postAttrInit",(function(t){t&&(e.quillAttr=t)})),Object(d.a)(Object(r.a)(e),"onAttributionChange",(function(t){return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.a.awrap(e.props.updateAttribution(Object(R.b)(t)));case 2:case"end":return n.stop()}}),null,null,null,Promise)})),Object(d.a)(Object(r.a)(e),"renderAttributionEditor",(function(t){return e.attrEditorRef=t,F(h.Fragment,null,F("div",{className:f()("credits-attribution-editor","paragraph"),ref:t}),F(I.a,{selector:".".concat("credits-attribution-editor"),hasRichTextEditor:!0,customAttributionColors:e.props.customAttributionColors}))})),Object(d.a)(Object(r.a)(e),"renderContent",(function(){var t={modules:{toolbar:Object(y.b)()?e.toolbarOptions.slice().reverse():e.toolbarOptions,keyboard:{bindings:{tab:{key:9,handler:e.handleTabAndEnterInContent},enter:{key:13,handler:e.handleTabAndEnterInContent}}}}};return F("div",{role:"button",onFocus:e.startEditingState,onBlur:e.stopEditingState},F(B.a,{variant:"inline",placeholder:e.props.intl.formatMessage({id:"builder.credits.content.placeholder"}),initHtml:e.props.content,onHtmlChange:e.onContentChange,render:e.renderContentEditor,tooltipLinkPlaceholder:S.c,initOptions:t,postQuillInit:e.postContentInit,id:e.props.blockId,disabledToolbarOptions:e.state.isPublicUser?{paragraph:["custom-input"]}:{paragraph:[]},disabledColorBtnTooltip:e.state.isPublicUser?e.props.intl.formatMessage({id:"publicAccount.disabled"}):"",shouldCompareInitialContent:!1,onFocus:e.formatContent,onCustomTextColorsChange:e.onCustomContentColorsChange}))})),Object(d.a)(Object(r.a)(e),"formatContent",(function(){1===e.quillContent.getText().length&&e.quillContent.format("bold",!0)})),Object(d.a)(Object(r.a)(e),"postContentInit",(function(t){t&&(e.quillContent=t,e.props.shouldFocusContent&&e.quillContent.focus())})),Object(d.a)(Object(r.a)(e),"handleTabAndEnterInContent",(function(){return e.quillContent.blur(),e.attrEditorRef.current&&(e.quillAttr.focus(),e.quillAttr.setSelection(e.quillAttr.getText().length)),!1})),Object(d.a)(Object(r.a)(e),"renderContentEditor",(function(t){var n="credits-content-editor";return F(h.Fragment,null,F("div",{ref:t,className:b.a.dynamic([["1013475989",[n,n,n]]])+" "+(f()(n,"paragraph")||"")}),F(I.a,{selector:".".concat(n),hasRichTextEditor:!0,customContentColors:e.props.customContentColors}),F(b.a,{id:"1013475989",dynamic:[n,n,n]},[".".concat(n,".__jsx-style-dynamic-selector .ql-editor{text-align:right;white-space:pre-wrap;}"),"html[dir='rtl'] .".concat(n,".__jsx-style-dynamic-selector .ql-editor{text-align:left;}"),".".concat(n,".__jsx-style-dynamic-selector .ql-editor a{white-space:initial;}")]))})),Object(d.a)(Object(r.a)(e),"onContentChange",(function(t){return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.formatContent(),n.next=3,s.a.awrap(e.props.updateContent(Object(R.b)(t)));case 3:case"end":return n.stop()}}),null,null,null,Promise)})),Object(d.a)(Object(r.a)(e),"startEditingState",(function(){clearTimeout(e.timeoutID),e.setState({isEditing:!0})})),Object(d.a)(Object(r.a)(e),"stopEditingState",(function(){e.timeoutID=setTimeout((function(){e.setState({isEditing:!1})}),0)})),Object(d.a)(Object(r.a)(e),"onCustomContentColorsChange",(function(t){return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.a.awrap(e.props.updateCustomContentColors(t));case 2:case"end":return n.stop()}}),null,null,null,Promise)})),Object(d.a)(Object(r.a)(e),"onCustomAttrColorsChange",(function(t){return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.a.awrap(e.props.updateCustomAttributionColors(t));case 2:case"end":return n.stop()}}),null,null,null,Promise)})),e.state={isEditing:!1,shouldShowActionBtns:!1},e.plusBtnRef=Object(h.createRef)(),e}return Object(a.a)(o,[{key:"shouldComponentUpdate",value:function(t,e){return!this.state.isEditing||this.state.isEditing!==e.isEditing||this.state.isPublicUser!==e.isPublicUser}},{key:"componentDidMount",value:function(){return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.props.userSession){t.next=7;break}return t.t0=this,t.next=4,s.a.awrap(Object(C.i)(this.props.userSession));case 4:t.t1=t.sent,t.t2={isPublicUser:t.t1},t.t0.setState.call(t.t0,t.t2);case 7:case"end":return t.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){return F(h.Fragment,null,F("div",{onMouseEnter:this.showActionButtons,onMouseLeave:this.hideActionButtons,onFocus:this.onFocus,onBlur:this.onBlur,className:b.a.dynamic([["2702497040",[j.a.spacing.xxxs,E.a.hexA(this.props.storyDesign.storyTheme.themeVariables.titleColor,.05)]]])+" attribution"},F(D.a,null,"boolean"===typeof this.state.isPublicUser&&this.renderContent(),F(q.a,null),"boolean"===typeof this.state.isPublicUser&&this.renderAttribution()),!this.props.isTheOnlyAttributionBlock()&&(this.state.shouldShowActionBtns||this.props.isTouchDevice)&&this.renderActionButtons(),this.renderPlusButton()),F(b.a,{id:"2702497040",dynamic:[j.a.spacing.xxxs,E.a.hexA(this.props.storyDesign.storyTheme.themeVariables.titleColor,.05)]},[".attribution.__jsx-style-dynamic-selector{position:relative;padding:".concat(j.a.spacing.xxxs," 0;}"),".attribution.__jsx-style-dynamic-selector:focus-within{background-color:".concat(E.a.hexA(this.props.storyDesign.storyTheme.themeVariables.titleColor,.05),";}")]))}}]),o}(h.Component);e.default=Object(T.b)(Object(_.c)(Object(m.c)(Object(k.b)(N))))}}]);