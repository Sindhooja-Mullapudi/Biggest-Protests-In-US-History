(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{xVra:function(t,e,n){"use strict";n.r(e),n.d(e,"NavigationBuilder",(function(){return E}));var a=n("VtSi"),i=n.n(a),s=n("fGyu"),o=n("9fIP"),c=n("MMYH"),r=n("pWxA"),u=n("K/z8"),l=n("sRHE"),p=n("8K1b"),d=n("zjfJ"),b=n("yFcC"),f=n.n(b),h=n("ERkP"),x=n.n(h),m=n("2SGB"),g=n("YQpL"),O=n("NX3A"),j=n("wwFW"),y=n("LqVs"),S=n("Abkm"),C=n("Z34l"),v=n("/StV"),k=n("dV92"),T=n("2bAO"),w=n("DpQq"),R=n("liFR"),V=n("7Vmz"),M=n("xkor"),D=x.a.createElement;function N(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var B=function(t){Object(p.a)(a,t);var e,n=(e=a,function(){var t,n=Object(l.a)(e);if(N()){var a=Object(l.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(u.a)(this,t)});function a(t){var e;return Object(o.a)(this,a),e=n.call(this,t),Object(d.a)(Object(r.a)(e),"inputRef",Object(h.createRef)()),Object(d.a)(Object(r.a)(e),"resetText",(function(){e.props.onTextChange(e.props.defaultValue,e.props.id)})),Object(d.a)(Object(r.a)(e),"onBlur",(function(){e.setState({isInputFocused:!1})})),Object(d.a)(Object(r.a)(e),"onCheckboxChange",(function(){e.setState({isChecked:!e.state.isChecked}),e.props.onCheckboxChange(e.props.id)})),Object(d.a)(Object(r.a)(e),"onTextareaChange",(function(t){t.target.value.length>=31&&(t.target.value=t.target.value.slice(0,29)),e.props.onTextChange(t.target.value,e.props.id),e.setState({isInputFocused:!0})})),e.state={isChecked:e.props.isChecked,isInputFocused:!1},e.onTextareaChange=e.onTextareaChange.bind(Object(r.a)(e)),e}return Object(c.a)(a,[{key:"render",value:function(){var t=this.props.customValue?this.props.customValue:this.state.isInputFocused?"":this.props.defaultValue;return t.length>30&&(t=t.slice(0,30).concat("...")),D(h.Fragment,null,D(T.a,{value:t,isChecked:this.state.isChecked,onChange:this.onCheckboxChange,disabled:this.props.disabledCheckbox}),D("span",{className:f.a.dynamic([["3500094713",[O.a.spacing.xxs,O.a.spacing.xxs,O.a.spacing.sm,O.a.spacing.xxs,O.a.spacing.xxs]]])+" input-container"},D(w.a,{inputRef:this.inputRef,type:"text",onChange:this.onTextareaChange,value:t,maxLength:30,onBlur:this.onBlur})),t.length>=30&&D("div",{className:f.a.dynamic([["3500094713",[O.a.spacing.xxs,O.a.spacing.xxs,O.a.spacing.sm,O.a.spacing.xxs,O.a.spacing.xxs]]])+" error"},D(R.a,{tooltipContent:this.props.intl.formatMessage({id:"builder.storyNavigation.characterLimit.tooltip"})},D(V.a,{color:O.a.color.alertRed}))),D("button",{onClick:this.resetText,"aria-label":this.props.intl.formatMessage({id:"builder.storyNavigation.headingReset"}),className:f.a.dynamic([["3500094713",[O.a.spacing.xxs,O.a.spacing.xxs,O.a.spacing.sm,O.a.spacing.xxs,O.a.spacing.xxs]]])+" reset-text"},t!==this.props.defaultValue&&D(R.a,{tooltipContent:this.props.intl.formatMessage({id:"builder.storyNavigation.headingReset"})},D(M.a,null))),D(f.a,{id:"3500094713",dynamic:[O.a.spacing.xxs,O.a.spacing.xxs,O.a.spacing.sm,O.a.spacing.xxs,O.a.spacing.xxs]},[".input-container.__jsx-style-dynamic-selector{width:100%;margin-right:".concat(O.a.spacing.xxs,";margin-left:0;}"),"html[dir='rtl'] .input-container.__jsx-style-dynamic-selector{margin-left:".concat(O.a.spacing.xxs,";margin-right:0;}"),".error.__jsx-style-dynamic-selector{position:relative;left:-".concat(O.a.spacing.sm,";margin-left:-").concat(O.a.spacing.xxs,";height:3rem;}"),".reset-text.__jsx-style-dynamic-selector{width:".concat(O.a.spacing.xxs,";}")]))}}]),a}(h.PureComponent),P=Object(g.c)(B),_=x.a.createElement;function F(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var I=function(t){Object(p.a)(a,t);var e,n=(e=a,function(){var t,n=Object(l.a)(e);if(F()){var a=Object(l.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(u.a)(this,t)});function a(t){var e;Object(o.a)(this,a),e=n.call(this,t),Object(d.a)(Object(r.a)(e),"renderModalBody",(function(t,n){var a=e.props.maxSelected&&!e.currentOptions[n].isSelected&&e.state.numberOfSelected>=e.props.maxSelected;return _("div",{key:e.currentOptions[n].id,className:f.a.dynamic([["1248275428",[O.a.spacing.xxs]]])+" option"},_(P,{id:e.currentOptions[n].id,defaultValue:e.currentOptions[n].defaultValue,customValue:t,isChecked:e.currentOptions[n].isSelected,onCheckboxChange:e.onCheckboxChange,onTextChange:e.onTextChange,disabledCheckbox:!!a}),_(f.a,{id:"1248275428",dynamic:[O.a.spacing.xxs]},[".option.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:".concat(O.a.spacing.xxs,";}")]))})),Object(d.a)(Object(r.a)(e),"getOptionsCustomText",(function(){return e.props.checkboxOptions.reduce((function(t,e){return e.customValue?[].concat(Object(s.a)(t),[e.customValue]):[].concat(Object(s.a)(t),[""])}),[])})),Object(d.a)(Object(r.a)(e),"getNumSelected",(function(){return e.props.maxSelected?e.props.checkboxOptions.reduce((function(t,n){return n.isSelected&&t<e.props.maxSelected?t+1:t}),0):0})),Object(d.a)(Object(r.a)(e),"onCheckboxChange",(function(t){var n=e.currentOptions.find((function(e){return e.id===t}));if(n){var a=!n.isSelected;e.setState((function(t){return{numberOfSelected:a?t.numberOfSelected+1:t.numberOfSelected-1}})),n.isSelected=a}})),Object(d.a)(Object(r.a)(e),"onTextChange",(function(t,n){e.setState((function(a){var i=e.currentOptions.findIndex((function(t){return t.id===n})),o=Object(s.a)(a.optionsCustomText);return i>-1&&(t===e.currentOptions[i].defaultValue?(e.currentOptions[i].customValue="",o[i]=""):(e.currentOptions[i].customValue=t,o[i]=t)),{optionsCustomText:o}}))})),Object(d.a)(Object(r.a)(e),"updateOptions",(function(){e.props.onConfirm(e.currentOptions)})),Object(d.a)(Object(r.a)(e),"closeMediaOptions",(function(){e.props.onDiscard()})),e.currentOptions=e.props.checkboxOptions;var i=e.getNumSelected(),c=e.getOptionsCustomText();return e.state={numberOfSelected:i,optionsCustomText:c},e}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(t){if(this.props.checkboxOptions!==t.checkboxOptions){this.currentOptions=this.props.checkboxOptions;var e=this.getNumSelected(),n=this.getOptionsCustomText();this.setState({numberOfSelected:e,optionsCustomText:n})}}},{key:"render",value:function(){var t=this,e="undefined"===typeof this.props.isShowingModal||this.props.isShowingModal,n=this.props.saveBtnText||_(m.a,{id:"builder.common.save"});return _(k.a,{isShowingModal:e,onCloseButtonClick:this.closeMediaOptions,headerTitle:this.props.modalTitle,headerSubtitle:this.props.modalSubtitle,primaryButtonTitle:n,onPrimaryButtonClick:this.updateOptions,secondaryButtonTitle:_(m.a,{id:"common.cancel"}),onSecondaryButtonClick:this.closeMediaOptions,closeButtonLabel:this.props.intl.formatMessage({id:"common.close"}),primaryButtonDisabled:this.props.saveDisabled},_(h.Fragment,null,this.state.optionsCustomText.map((function(e,n){return t.renderModalBody(e,n)}))))}}]),a}(h.PureComponent),z=Object(g.c)(I),L=n("3SKz"),U=x.a.createElement;function A(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var E=function(t){Object(p.a)(a,t);var e,n=(e=a,function(){var t,n=Object(l.a)(e);if(A()){var a=Object(l.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(u.a)(this,t)});function a(t){var e;return Object(o.a)(this,a),e=n.call(this,t),Object(d.a)(Object(r.a)(e),"iconStyles",{styles:U(f.a,{id:"1490427372",dynamic:[O.a.spacing.xxxs]},[".icon.__jsx-style-dynamic-selector{margin-right:".concat(O.a.spacing.xxxs,";}")]),className:f.a.dynamic([["1490427372",[O.a.spacing.xxxs]]])}),Object(d.a)(Object(r.a)(e),"mediaToolbarStyles",{styles:U(f.a,{id:"3578325757"},[".toolbar-wrapper.jsx-3578325757{bottom:0;}"]),className:"jsx-3578325757"}),Object(d.a)(Object(r.a)(e),"renderSettingsModal",(function(){var t=e.props.links.reduce((function(t,e){var n={id:e.nodeId,defaultValue:e.defaultText?Object(S.d)(e.defaultText):e.defaultText,customValue:e.customText?Object(S.d)(e.customText):e.customText,isSelected:!e.isHidden};return[].concat(Object(s.a)(t),[n])}),[]);return U(z,{isShowingModal:e.state.isShowingSettings,modalTitle:U(m.a,{id:"builder.navigation.title"}),modalSubtitle:U(m.a,{id:"builder.storyNavigation.subtitle"}),onConfirm:e.onConfirm,onDiscard:e.onDiscard,checkboxOptions:t,maxSelected:e.props.maxLinks})})),Object(d.a)(Object(r.a)(e),"onSettingsClicked",(function(){e.setState({isShowingSettings:!e.state.isShowingSettings})})),Object(d.a)(Object(r.a)(e),"onConfirm",(function(t){var n=t.reduce((function(t,e){var n={nodeId:e.id,customText:e.customValue,isHidden:!e.isSelected};return[].concat(Object(s.a)(t),[n])}),[]);e.props.updateLinks(n),e.setState({isShowingSettings:!1})})),Object(d.a)(Object(r.a)(e),"onDiscard",(function(){e.setState({isShowingSettings:!1})})),e.state={isShowingSettings:!1},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.props.userSession){t.next=7;break}return t.t0=this,t.next=4,i.a.awrap(Object(C.i)(this.props.userSession));case 4:t.t1=t.sent,t.t2={isPublicUser:t.t1},t.t0.setState.call(t.t0,t.t2);case 7:case"end":return t.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){return U("div",{className:"navigation-builder"},"boolean"===typeof this.state.isPublicUser&&U(v.a,{shouldShowMediaToolbar:this.props.links.length>0,size:void 0,possibleSizes:{full:!1,float:!1,wide:!1,standard:!1},toolbarPosition:"bottom",shouldUseCompactToolbar:!0,shouldUseSmallOverlap:!0,mediaSpecificActions:[{buttonId:"properties",icon:j.a,iconSize:"2rem",onClick:this.onSettingsClicked,isDisabled:this.state.isPublicUser,tooltipContent:this.props.intl.formatMessage({id:this.state.isPublicUser?"publicAccount.disabled":"builder.mediaToolbar.properties"})}]},U(L.default,this.props),this.mediaToolbarStyles.styles),this.renderSettingsModal(),this.iconStyles.styles)}}]),a}(h.PureComponent);e.default=Object(g.c)(Object(y.b)(E))}}]);